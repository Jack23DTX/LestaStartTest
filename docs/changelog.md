# Changelog

## Feedback

От ...

## Версия 2.2.0 14.06.2025

### Нововведения
- **Backend:**
    - API-эндпоинт `/api/documents/:id/huffman` для получения Хаффман-кода содержимого документа.
    - Реализация алгоритма Хаффмана (кодирование) в пакете `internal/calculation/huffman.go`.
    - Unit-тесты для алгоритма Хаффмана (`huffman_test.go`).
    - Ограничение на размер документа для кодирования (10 МБ).
- **Frontend:**
    - Кнопка “Хаффман-код” для получения кодировки документа через API.
    - Отображение ошибок и статуса при получении Хаффман-кода.
- **Общее:**
    - Swagger-документация для новых эндпоинтов.
    - Обновлена структура проекта (актуальная структура см. в README).

---

## Версия 2.1.1 (12.06.2025)

### Нововведения

- **Swagger-документация**:
    - Добавлена документация Swagger для описания всех доступных эндпоинтов API.
    - Обеспечено удобство взаимодействия разработчиков с API.

### Изменения

- **Вывод версии приложения**:
    - Эндпоинт `/version` теперь выводит информацию о версии из переменных окружения (`VERSION`).
    
### Исправления

- Небольшие исправления в API для повышения стабильности и производительности.

---

## Версия 2.0.0 (12.06.2025)

### Нововведения

- **Полный переход на SPA**:
    - Фронтенд переведён на модель Single Page Application, взаимодействие происходит исключительно через API.
    - Устаревшие HTML-шаблоны удалены.

- **Поддержка PostgreSQL**:
    - Реализована интеграция с PostgreSQL для хранения данных о пользователях, документах, коллекциях и IDF.
    - Переменные окружения `DB_*` теперь обязательны для подключения к базе данных.

- **Docker Compose**:
    - Добавлен файл `docker-compose.yml` для запуска приложения и PostgreSQL в связке.
    - Конфигурация сервиса базы данных включает проверку готовности через `pg_isready`.

- **JWT-аутентификация**:
    - Реализована аутентификация с использованием JWT-токенов.
    - Добавлены middleware для проверки токенов и обработки ошибок 401.

- **Расчёты TF-IDF**:
    - Добавлены функции для вычисления Term Frequency (TF) и Inverse Document Frequency (IDF).
    - Статистика TF-IDF доступна для каждого документа и коллекции через соответствующие эндпойнты.

- **Обновление сущностей**:
    - Реализованы новые сущности в базе данных:
        - **Пользователи**: хранение информации о пользователях (логин, пароль).
        - **Документы**: хранение загруженных документов, их содержимого и обработанных данных.
        - **Коллекции**: хранение созданных пользователями коллекций и документов в них.
        - **IDF Коллекции**: хранение данных IDF для слов в коллекциях.

- **Новые эндпойнты**:
    - **Публичные API**:
        - `/login` - аутентификация пользователя.
        - `/register` - регистрация нового пользователя.
    - **Защищённые API**:
        - `/api/documents` - получение списка документов.
        - `/api/documents/upload` - загрузка документов.
        - `/api/documents/:id` - получение документа по ID.
        - `/api/documents/:id/statistics` - статистика документа (TF-IDF).
        - `/api/documents/:id` (DELETE) - удаление документа.
        - `/api/collections` - создание коллекции, получение списка коллекций.
        - `/api/collections/:id` - получение коллекции по ID.
        - `/api/collections/:id/statistics` - статистика коллекции (TF-IDF).
        - `/api/collection/:collection_id/:document_id` - добавление документа в коллекцию.
        - `/api/collection/:collection_id/:document_id` (DELETE) - удаление документа из коллекции.
        - `/api/collections/:id` (DELETE) - удаление коллекции.
        - `/api/user/:user_id` (PATCH) - изменение пароля пользователя.
        - `/api/user/:user_id` (DELETE) - удаление пользователя.
        - `/api/logout` - выход из аккаунта.

- **Улучшена обработка загрузки файлов**:
    - Реализована поддержка многопоточной обработки загружаемых файлов.
    - Загрузки сохраняются в директории пользователя, организованной по ID.

- **Обновлён Dockerfile**:
    - Добавлены зависимости для работы с JWT и обработки загрузок.

---

## Версия 1.1.0 (01.06.2025)

### Нововведения

- Вынесение порта:
    - Порт для запуска сервера использует переменную окружения `MAIN_PORT` из файла `.env` вместо жёстко прописанного значения.

- Добавлены эндпойнты:
    - `/status` - проверяет доступность приложения (`{“status”: “OK”}` - приложение работает без ошибок).
    - `/version` - показывает версию приложения.
    - `/metrics` - показывает метрики (`total_processed_documents` и `avg_processed_documents`).

- Обновлён Dockerfile:
    - Добавлена строка `COPY .env ./`.