# Структура базы данных

Этот документ описывает структуру базы данных, используемую в LestaStartTest. Ниже приведены таблицы и их атрибуты.

## Таблицы

### Пользователи (`users`)
Хранит информацию о зарегистрированных пользователях.

| Имя столбца    | Тип      | Ограничения                   | Описание                     |
|----------------|----------|-------------------------------|------------------------------|
| `id`           | `uint`   | `primary_key`                | Уникальный идентификатор пользователя. |
| `username`     | `string` | `unique`, `not null`         | Имя пользователя.           |
| `password`     | `string` | `not null`                   | Хэшированный пароль пользователя. |
| `created_at`   | `time`   |                               | Время создания пользователя. |

---

### Документы (`documents`)
Хранит информацию о загруженных документах.

| Имя столбца          | Тип      | Ограничения                                   | Описание                     |
|----------------------|----------|-----------------------------------------------|------------------------------|
| `id`                | `uint`   | `primary_key`                                | Уникальный идентификатор документа. |
| `user_id`           | `uint`   | `not null`, `index:idx_user_file,priority:1` | ID пользователя, которому принадлежит документ. |
| `filename`          | `string` | `not null`, `index:idx_user_file,priority:2`, `unique` | Имя файла документа. |
| `content`           | `string` | `type:text`, `not null`                      | Оригинальное содержимое документа. |
| `original_path`     | `string` | `not null`                                   | Путь к загруженному файлу. |
| `processed_content` | `string` | `type:text`, `not null`                      | Обработанное содержимое для анализа. |
| `created_at`        | `time`   |                                             | Время создания документа. |

---

### Коллекции (`collections`)
Хранит информацию о коллекциях, созданных пользователями.

| Имя столбца          | Тип      | Ограничения          | Описание                     |
|----------------------|----------|----------------------|------------------------------|
| `id`                | `uint`   | `primary_key`       | Уникальный идентификатор коллекции. |
| `user_id`           | `uint`   | `not null`, `index` | ID пользователя, которому принадлежит коллекция. |
| `name`              | `string` | `not null`          | Имя коллекции.              |
| `created_at`        | `time`   |                      | Время создания коллекции. |

---

### IDF Коллекции (`collection_idf`)
Хранит значения IDF, рассчитанные для слов в коллекции.

| Имя столбца          | Тип      | Ограничения          | Описание                     |
|----------------------|----------|----------------------|------------------------------|
| `id`                | `uint`   | `primary_key`       | Уникальный идентификатор записи IDF. |
| `collection_id`     | `uint`   | `not null`, `index` | ID связанной коллекции.      |
| `word`              | `string` | `not null`, `index` | Слово, для которого рассчитано значение IDF. |
| `idf_value`         | `float`  | `not null`          | Значение IDF слова.          |

---

### Связи

#### Коллекции ↔ Документы
Коллекции и документы связаны отношением многие-ко-многим, которое представлено таблицей `collection_documents`.

| Имя столбца          | Тип      | Ограничения          | Описание                     |
|----------------------|----------|----------------------|------------------------------|
| `collection_id`     | `uint`   | `foreign key`       | ID связанной коллекции.      |
| `document_id`       | `uint`   | `foreign key`       | ID связанного документа.     |

---

## Диаграмма

Ниже представлена ER-диаграмма, отображающая связи между таблицами:

```plaintext
+------------+       +------------+       +---------------+
|   Users    |       | Documents  |       |  Collections  |
+------------+       +------------+       +---------------+
| id         |<----->| user_id    |       | user_id       |
| username   |       | filename   |<----->| id            |
| password   |       | content    |       | name          |
| created_at |       | created_at |       | created_at    |
+------------+       +------------+       +---------------+
```
```plaintext
+-------------------+
|  Collection IDF   |
+-------------------+
| id                |
| collection_id     |
| word              |
| idf_value         |
+-------------------+
```