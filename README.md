# Тестовое задание: TF-IDF Web App

## Описание

Это веб-приложение позволяет пользователю загружать текстовые файлы для последующего анализа **TF (Term Frequency)** и **IDF (Inverse Document Frequency)** слов в тексте.

## Структура проекта

- `cmd/`: Содержит точку входа основного приложения (`main.go`).
- `internal/`: Содержит внутренние пакеты:
   - `calculation/`: Функции для вычислений TF и IDF.
   - `controllers/`: Обработчики HTTP для приложения.
   - `monitoring/`: Сбор и отчетность по метрикам.
   - `templates/`: HTML-шаблоны для веб-интерфейса.
- `dockerfile`: Инструкции для сборки Docker-образа.
- `.env`: Файл конфигурации переменных окружения.
- `go.mod`, `go.sum`: Файлы модулей Go для управления зависимостями.

## Требования

- **Go** версии 1.23 или выше.
- Используется фреймворк **Gin** для работы с HTTP.
- Используется библиотека **Testify** для небольшого тестирования вычислений.
- Стандартные библиотеки Go для обработки строк, файлов и вычислений.

## Функциональность:

1. **Загрузка файлов**: Приложение поддерживает загрузку нескольких текстовых файлов одновременно через форму.
2. **Вычисление TF и IDF**:
    - **TF (Term Frequency)** — частота появления слова в тексте.
    - **IDF (Inverse Document Frequency)** — обратная частота документа, которая помогает вычислить важность каждого слова в рамках множества документов.
3. **Отображение результатов**:
    - После загрузки и обработки файлов выводится таблица (до 50 слов).
    - Таблица включает следующие колонки:
        - **Слово**
        - **TF** — сколько раз слово встречается в тексте.
        - **IDF** — обратная частота документа.

## Конфигурируемые параметры (`.env`)
Все параметры находятся в корне проекта в файле `.env`. Для удобства приведён пример ` .env.example`.  
При запуске приложение загружает переменные окружения из файла `.env` (используется функция `godotenv.Load()`).

### Список переменных

```dotenv
# Порт, на котором будет запущен HTTP-сервер (обязательная)
MAIN_PORT=:8080

# Параметры подключения к базе данных (если планируется хранить результаты или логи)
# Если БД не используется, оставить пустыми или закомментировать.
DB_HOST=localhost
DB_PORT=5432
DB_USER=username
DB_PASSWORD=password
DB_NAME=tfidf_db
```

## Как запустить приложение

### Вариант 1: Локальный запуск

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/yourusername/LestaStartTest.git
   cd LestaStartTest
   ```

2. **Создайте файл .env, скопировав содержимое из .env.example, и при необходимости скорректируйте значения:**
   ```bash
   cp .env.example .env
   # Откройте .env и проверьте/измените порты и параметры БД
   ```

3. **Скачайте зависимости для Go:**
   
   ```bash
   go mod download
   ```
   
3. **Запустите приложение:**

   ```bash
   go run cmd/main.go
   ```

Приложение будет доступно по адресу http://localhost:8080.

### Вариант 2: Запуск через Docker

1. **Соберите Docker-образ:**\
   Из корня проекта выполните команду для создания Docker-образа:

   ```bash
   docker build -t LestaStartTest .
   ```
   
2. **Запустите контейнер с приложением:**\
   Запустите контейнер и откройте порт 8080:

   ```bash
   docker run -p 8080:8080 LestaStartTest:1.1.0
   ```
   
3. **Доступ к приложению:**\
   Перейдите по адресу http://localhost:8080 в браузере для взаимодействия с приложением.


## Тестирование

В проекте реализованы базовые модульные тесты с использованием библиотеки [Testify](https://github.com/stretchr/testify).  
Тесты проверяют корректность расчета TF и IDF для различных случаев.

### Запуск тестов

Для запуска тестов выполните команду:

   ```bash
   go test ./...
   ```

## Changelog

### Версия 1.1.0 (01.06.2025)

- Вынесение порта:
  - Порт для запуска сервера использует переменную окружения `MAIN_PORT` из файла `.env` вместо жёстко прописанного значения.
  
- Добавлены эндпойнты:
  - `/status` - проверяет доступность приложение (`{“status”: “OK”}` - приложение работает без ошибок).
  - `/version` - показывает версию приложения.
  - `/metrics` - показывает метрики (`total_processed_documents` и `avg_processed_documents`)

- Обновлён Dockerfile:
  - Добавлена строка COPY `.env ./`

### Примечания
- Аргументация метрик:
   - `total_processed_documents`(общее число обработанных запросов загрузки файлов) помогает отслеживать нагрузку и общее количество обращений пользователей. Это может быть полезно для мониторинга системы и планирования масштабирования.
   - `avg_processed_documents` (среднее время обработки (в миллисекундах) одного запроса) важен для оценки производительности: позволяет видеть, сколько времени в среднем тратится на обработку файлов. Если метрика резко возрастает, это сигнал к оптимизации кода или ресурсов.
  

- Работа с БД: в текущей версии функциональность с хранением результатов или логов в БД не реализована. В будущем планируется добавить поддержку PostgreSQL, тогда переменные DB_* станут обязательными.
- Планируется добавление Docker Compose для запуска нескольких сервисов (приложение + БД).

